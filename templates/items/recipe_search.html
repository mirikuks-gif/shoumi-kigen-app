<!DOCTYPE html>
<html lang="ja">
<head>
    {% load static %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <meta name="theme-color" content="#2196f3">
    <title>ãƒ¬ã‚·ãƒ”æ¤œç´¢</title>
    <link rel="stylesheet" href="{% static 'css/recipes.css' %}">
</head>
<body>
    <h1>æ¶ˆè²»ææ¡ˆã®çŒ®ç«‹ ğŸ³</h1>
    <p>
        <a href="{% url 'item_list' %}">é£Ÿæä¸€è¦§ã«æˆ»ã‚‹</a>
    </p>
    <hr>

    <!-- æ‰‹å‹•ãƒ¬ã‚·ãƒ”æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
    <section class="manual-search">
        <h2>æ‰‹å‹•ãƒ¬ã‚·ãƒ”æ¤œç´¢</h2>
        <form method="get" action="{% url 'manual_recipe_search' %}">
            <label for="ingredients">
                é£Ÿæã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šé¶ã‚€ã­è‚‰, ç‰ã­ã, åµï¼‰:
            </label><br>
            <input type="text" id="ingredients" name="ingredients" size="60"
                value="{{ keyword|default:'' }}"
                placeholder="ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å…¥åŠ›" required>
            <button type="submit">ãƒ¬ã‚·ãƒ”æ¤œç´¢</button>
        </form>
    </section>

    <!-- åœ¨åº«é£Ÿæä¸€è¦§ -->
    <section class="stock-section">
        <h2>ç¾åœ¨ã®åœ¨åº«é£Ÿæ</h2>
        <div class="stock-container">
            {% if item_list %}
                <ul class="stock-list">
                    {% for item in item_list %}
                        <li>
                            {{ item.name }} ({{ item.quantity }}å€‹, {{ item.location.name }})
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>åœ¨åº«é£Ÿæã¯ã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
            {% endif %}
        </div>
    </section>

    <hr>

    <!-- æ¤œç´¢çµæœ -->
    <section class="search-results">
        {% if recipes %}
            <h2>æ¤œç´¢çµæœ ({{ keyword }} ã‚’åˆ©ç”¨)</h2>
            <div class="recipe-container">
                {% for recipe in recipes %}
                    <div class="recipe-card">
                        <h4>
                            <a href="{{ recipe.url }}" target="_blank">{{ recipe.title }}</a>
                        </h4>
                        {% if recipe.image_url %}
                            <img src="{{ recipe.image_url }}" alt="{{ recipe.title }}">
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        {% else %}
            {% if keyword %}
                <p>ã€Œ{{ keyword }}ã€ã«ä¸€è‡´ã™ã‚‹ãƒ¬ã‚·ãƒ”ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
            {% endif %}
        {% endif %}
    </section>

    <!-- Service Worker ç™»éŒ² -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register("{% static 'js/service-worker.js' %}")
                .then(reg => console.log('Service Worker registered', reg))
                .catch(err => console.log('Service Worker registration failed', err));
        }
    </script>
</body>
</html>
